<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js - The HTML Presentation Framework</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/night.css" id="theme">
        <link href="/css/custom/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
                <section>
                    <h1>RabbitMQ</h1>
                    <img src="images/RabbitMQ.png" width="300" />
                </section>

				<section>
					<h2>Pretty Code</h2>
					<pre><code data-trim contenteditable>
function linkify( selector ) {
  if( supports3DTransforms ) {

    var nodes = document.querySelectorAll( selector );

    for( var i = 0, len = nodes.length; i &lt; len; i++ ) {
      var node = nodes[i];

      if( !node.className ) {
        node.className += ' roll';
      }
    }
  }
}
					</code></pre>
				</section>

                <section>
                    <h2>Un broker di messaggistica</h2>
                </section>

                <section>
                    <img src="images/erlang.png" />
                    <h2>Scritto in erlang</h2>
                    <ul>
                        <li class="fragment roll-in">sistemi real-time high availability</li>
                        <li class="fragment roll-in">telecoms, banking, e-commerce, computer telephony and instant messaging</li>
                        <li class="fragment roll-in">supporto nativo per concorrenzialità, distribuzione e fault tolerance</li>
                    </ul>
                </section>

                <section>
                    <img src="images/Pivotal_Logo.png" />
                    <h2>Mantenuto da pivotal</h2>
                    <ul>
                        <li class="fragment roll-in">Redis</li>
                        <li class="fragment roll-in">Spring framework</li>
                        <li class="fragment roll-in">Hadoop</li>
                    </ul>
                </section>

                <section>
                    <h2>Come installare RabbitMQ?</h2>
                    <br />
                    <div class="fragment"><h3>linux / debian</h3>apt-get install rabbitmq-server</div>
                    <br />
                    <div class="fragment"><h3>osx</h3>brew install rabbitmq</div>
                    <div class="fragment"><img src="images/too-easy.jpg" /></div>
                </section>

                <section>
                    <h2>Windows?</h2>
                    <img src="images/jimi.gif" class="fragment">
                    <p class="fragment">there is an exe for that...</p>
                </section>

                <section>
                    <h1>Perchè Rabbit?</h1>
                    <ul>
                        <li class="fragment roll-in">è open</li>
                        <li class="fragment roll-in">supporta il protocollo AMQP</li>
                        <li class="fragment roll-in">scalabile</li>
                        <li class="fragment roll-in">
                            bindings per molti linguaggi
                            <ul>
                                <li>php</li>
                                <li>ruby</li>
                                <li>C#</li>
                                <li>java</li>
                                <li>perl</li>
                                <li>erlang</li>
                                <li>clojure</li>
                                <li>COBOL!</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section>
                    <h4>Perchè Rabbit?</h4>
                    <h2>X &times; 100.000 messaggi al secondo...</h2>
                </section>

                <section>
                    <h4>Perchè Rabbit?</h4>
                    <h2>realtime is the new loud</h2>
                </section>

                <section>
                    <h4>Perchè Rabbit?</h4>
                    <h2>scalability is the new loud</h2>
                </section>

                <section>
                    <h4>Perchè Rabbit?</h4>
                    <h2>multi-language is the new loud</h2>
                </section>


                <section>
                    <h1>AMQP</h1>
                    <h5>Advanced Message Queuing Protocol</h5>
                </section>

                <section>
                    <p>Un layer applicativo standard aperto per middleware orientati ai messaggi</p>
                    <p>creato nel 2004 da John O'Hara (JPMorgan Chase)</p>
                    <p>in seguito adottatto come standard aperto da cisco, red hat, novell, microsoft, vmware</p>
                </section>

                <section>
                    <p>RabbitMQ implementa il protocollo AMQP nativamente</p>
                    <p>Altri protocolli come stomp, MQTT e http sono installabili via plugin</p>
                    <br />
                    <p>AMQP è la scelta più facile e migliore</p>
                </section>

                <section>
                    <h1>Back to the rabbit</h1>
                    <img src="images/ravingrabbids.jpg" height="400">
                </section>

                <section>
                    <h2>come funzionano i messaggi?</h2>
                </section>

                <section>
                    <p>a day in the life of a message</p>
                    <img src="images/message-flow.png" />
                </section>

                <section>
                    <img src="images/hello-world-example-routing.png" />
                </section>

                <section>
                    <h1>rabbit è:</h1>
                </section>

                <section>
                    <h3>Messaggi</h3>
                    <p>Un messaggio non è altro che IL dato</p>
                    <p>è composto da un body e da un payload</p>
                </section>

                <section>
                    <h3>producer</h3>
                    <p>produce messaggi</p>
                    <h3>consumer</h3>
                    <p>consuma messaggi</p>
                </section>

                <section>
                    <h3>Exchange</h3>
                    <p>Business logic dell'applicazione</p>
                    <p>Riceve i messaggi e li smista</p>
                </section>

                <section>
                    <h3>Queue</h3>
                    <br />
                    <p>coda di messaggi in attesa di essere gestiti da un consumer</p>
                    <p>in un certo senso un consumer <strong>è</strong> una coda</p>
                    <p class="fragment roll-in">di default i messaggi in rabbit non sono durevoli (durable) nel tempo</p>
                    <p class="fragment roll-in">quindi no consumer, no coda, no party...</p>
                    <p class="fragment roll-in">message black holed...<br /><img src="images/black_hole_image.jpg"></p>
                </section>

                <section>
                    <p>show me the code...</p>
                    <img src="images/i-have-no-idea-what-im-doing-dog.jpg" />
                </section>

                <section>
                    <h2>composer.json</h2>
                    <pre>
                        <code data-trim>
{
    "require": {
        "videlalvaro/php-amqplib": "~2.2.6"
    }
}
                        </code>
                    </pre>
                </section>

                <section>
                    <pre>
                        <code data-trim>
use PhpAmqpLib\Connection\AMQPConnection;
use PhpAmqpLib\Message\AMQPMessage;

$connection = new AMQPConnection('localhost', 5672, 'guest', 'guest');
$channel = $connection->channel();

// codice

$channel->close();
$connection->close();
                        </code>
                    </pre>
                </section>

                <section>
                    <pre>
                        <code data-trim>
// dichiaro una coda
$channel->queue_declare('hello');
// creo un messaggio
$msg = new AMQPMessage('Hello World!');
// pubblico
$channel->basic_publish($msg, '', 'hello');
                        </code>
                    </pre>
                    <pre>
                        <code data-trim>
/**
 * declare queue, create if needed
 */
public function  queue_declare($queue="", $passive=false, $durable=false,
                               $exclusive=false, $auto_delete=true,
                               $nowait=false, $arguments=null, $ticket=null) {}
/**
 * publish a message
 */
public function basic_publish($msg, $exchange="", $routing_key="",
                                  $mandatory=false, $immediate=false,
                                  $ticket=null) {}
                        </code>
                    </pre>
                </section>

                <section>
                    <h2>3 modelli principali di routing</h2>
                </section>

                <section>
                    <h2>direct exchange</h2>
                    <img src="images/direct.png" height="100" />
                    <p>utile per situazioni non durevoli, websockets etc.</p>
                    <p>il producer "decide" in quale coda finire</p>
                </section>

                <section>
                    <pre>
                        <code data-trim>
// dichiaro una coda
$channel->queue_declare('hello');
// creo un messaggio
$msg = new AMQPMessage('Hello World!');
// pubblico
$channel->basic_publish($msg, '', 'hello');
                        </code>
                    </pre>
                    <pre>
                        <code data-trim>
/**
 * declare queue, create if needed
 */
public function  queue_declare($queue="", $passive=false, $durable=false,
                               $exclusive=false, $auto_delete=true,
                               $nowait=false, $arguments=null, $ticket=null) {}
/**
 * publish a message
 */
public function basic_publish($msg, $exchange="", $routing_key="",
                                  $mandatory=false, $immediate=false,
                                  $ticket=null) {}
                        </code>
                    </pre>
                </section>

                <section>
                    <h2>fanout (publish/subscribe)</h2>
                    <img src="images/fanout.png" height="100" />
                    <p>implementa il pattern publish/subscribe</p>
                    <p>il producer pubblica un messaggio, se ci sono consumer in ascolto lo ricevono</p>
                </section>

                <section>
                    <h2>topic</h2>
                    <img src="images/topic.png" height="250">
                    <p>uno dei modelli più complessi</p>
                    <p>molto diffuso in sistemi che fanno largo uso di code</p>
                </section>

                <section>
                    <h3>Un messaggio non viene MAI messo direttamente in una coda</h3>
                    <p>questo romperebbe il principio secondo il quale il producer non sa se e quali consumer sono in ascolto</p>
                </section>

                <section>
                    <h3>Exchanges</h3>
                    <p>sono la business logic di rabbit. Decidono in quali code finiscono i messaggi</p>
                </section>

                <section>
                    <section>
                        <h3>cose da fare dopo aver installato rabbit</h3>
                    </section>
                    <section>
                        <h2>abilitare il management plugin</h2>
                        <pre>
                            <code data-trim>
                                rabbitmq-plugins enable rabbitmq_management
                            </code>
                        </pre>
                        <h4>http://localhost:15672/</h4>
                        <img class="fragment roll-in" src="images/rabbit-management.png" />
                    </section>
                    <section>
                        <h3>logs</h3>
                        <h4>su ubuntu server sono in /var/log/rabbitmq</h4>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Cose che avrei voluto sapere prima di cominciare ad usare rabbit</h2>
                    </section>

                    <section>
                        <h2>AMQP è un protocollo programmabile</h2>
                        <p>la logica sta nell'applicazione, non nel server</p>
                    </section>

                    <section>
                        <h3>non effettuare mai il routing nei consumer</h3>
                        <div class="fragment roll-in">
                            <h2>You are doing it wrong!</h2>
                            <img src="images/doing_it_wrong.jpg" />
                        </div>
                    </section>

                    <section>
                        <h3>fair dispatch</h3>
                        <p>i messaggi vengono assegnati immediatamente...appena arrivano</p>
                        <p>Non rimangono in attesa nell'exchanger</p>
                    </section>
                </section>

                <section>
                    <h2>Symfony</h2>
                    <h4 class="fragment roll-in">videlalvaro / RabbitMqBundle</h4>
                </section>

                <section>
                    <h1>grazie!</h1>
                </section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
					//{ src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
